function initProgressBarHandler(){myJsProgressBarHandler=new JS_BRAMUS.jsProgressBarHandler}var autoHook=!0,defaultOptions={animate:!0,showText:!0,width:120,boxImage:"images/bramus/percentImage.png",barImage:"images/bramus/percentImage_back.png",height:12,onTick:function(a){return!0}};if(!JS_BRAMUS)var JS_BRAMUS=new Object;JS_BRAMUS.jsProgressBar=Class.create(),JS_BRAMUS.jsProgressBar.prototype={el:null,id:null,percentage:null,options:null,initialPos:null,initialPerc:null,pxPerPercent:null,backIndex:null,numPreloaded:null,running:null,queue:!1,initialize:function(a,b,c){this.options=Object.clone(defaultOptions),Object.extend(this.options,c||{}),this.el=$(a),this.id=$(a).id,this.percentage=0,this.backIndex=0,this.numPreloaded=0,this.running=!1,this.queue=Array(),this.imgWidth=2*this.options.width,this.initialPos=this.options.width*-1,this.pxPerPercent=this.options.width/100,this.initialPerc=b,this.options.barImage.constructor!=Array&&(this.options.barImage=Array(this.options.barImage)),this.preloadImages()},preloadImages:function(){for(i=0;i<this.options.barImage.length;i++){var a=null;a=new Image,a.onload=function(){this.numPreloaded++}.bind(this),a.onerror=function(){this.numPreloaded++}.bind(this),a.onabort=function(){this.numPreloaded++}.bind(this),a.src=this.options.barImage[i],a.complete&&this.numPreloaded++}Prototype.Browser.IE?this.initVisuals():this.checkPreloadedImages()},checkPreloadedImages:function(){parseInt(this.numPreloaded,10)>=parseInt(this.options.barImage.length,10)?this.initVisuals():parseInt(this.numPreloaded,10)<=parseInt(this.options.barImage.length,10)&&setTimeout(function(){this.checkPreloadedImages()}.bind(this),100)},initVisuals:function(){$(this.el).update('<img id="'+this.id+'_percentImage" src="'+this.options.boxImage+'" alt="0%" style="width: '+this.options.width+"px; height: "+this.options.height+"px; background-position: "+this.initialPos+"px 50%; background-image: url("+this.options.barImage[this.backIndex]+'); padding: 0; margin: 0;" class="percentImage" />'+(1==this.options.showText?'<span id="'+this.id+'_percentText" class="percentText">0%</span>':"")),this.setPercentage(this.initialPerc)},setPercentage:function(a,b){b?(this.percentage=0!=this.queue.length?this.queue[0]:a,this.timer=null,this.queue=[],setTimeout(function(){this.setPercentage(a)}.bind(this),10)):(this.queue.push(a),0==this.running&&this.processQueue())},processQueue:function(){this.queue.length>0&&(this.running=!0,this.processQueueEntry(this.queue[0]))},processQueueEntry:function(a){var b=parseInt(this.percentage,10);if("+"!=a.toString().substring(0,1)&&"-"!=a.toString().substring(0,1)||(a=b+parseInt(a)),a<0&&(a=0),0==this.options.animate){if(this.queue.splice(0,1),this._setBgPosition(a),!this.options.onTick(this))return;return this.running=!1,void this.processQueue()}if(a!=b?(b<a?newPercentage=b+1:newPercentage=b-1,callTick=!0):(newPercentage=b,callTick=!1),this._setBgPosition(newPercentage),!callTick||this.options.onTick(this))return b==newPercentage?(this.queue.splice(0,1),this.running=!1,this.timer=null,void this.processQueue()):void(this.timer=setTimeout(function(){this.processQueueEntry(a)}.bind(this),10))},getPercentage:function(a){return this.percentage},_setBgPosition:function(a){$(this.id+"_percentImage").style.backgroundPosition=this.initialPos+a*this.pxPerPercent+"px 50%";var b=Math.floor((a-1)/(100/this.options.barImage.length));b!=this.backIndex&&void 0!=this.options.barImage[b]&&($(this.id+"_percentImage").style.backgroundImage="url("+this.options.barImage[b]+")"),this.backIndex=b,$(this.id+"_percentImage").alt=a+"%",$(this.id+"_percentImage").title=a+"%",1==this.options.showText&&($(this.id+"_percentText").update(" "+a+"%"),a>100?$(this.id+"_percentText").style.color="red":$(this.id+"_percentText").style.color="black"),this.percentage=a}},JS_BRAMUS.jsProgressBarHandler=Class.create(),JS_BRAMUS.jsProgressBarHandler.prototype={pbArray:new Array,initialize:function(){$$("span.progressBar").each(function(a){this.pbArray[a.id]=new JS_BRAMUS.jsProgressBar(a,parseInt(a.innerHTML.replace("%","")))}.bind(this))},setPercentage:function(a,b,c){this.pbArray[a].setPercentage(b,c)},getPercentage:function(a){return this.pbArray[a].getPercentage()}},1==autoHook&&document.observe("dom:loaded",initProgressBarHandler,!1);